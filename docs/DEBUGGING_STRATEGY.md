# DailyFortune ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ - ãƒ‡ãƒãƒƒã‚°æˆ¦ç•¥ã‚¬ã‚¤ãƒ‰

## ç›®æ¬¡
1. [ã¯ã˜ã‚ã«](#ã¯ã˜ã‚ã«)
2. [å•é¡Œã®åˆ‡ã‚Šåˆ†ã‘æˆ¦ç•¥](#å•é¡Œã®åˆ‡ã‚Šåˆ†ã‘æˆ¦ç•¥)
3. [ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ‡ãƒãƒƒã‚°å¼·åŒ–](#ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ‡ãƒãƒƒã‚°å¼·åŒ–)
4. [ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‡ãƒãƒƒã‚°å¼·åŒ–](#ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‡ãƒãƒƒã‚°å¼·åŒ–)
5. [APIé€šä¿¡ãƒ‡ãƒãƒƒã‚°å¼·åŒ–](#apié€šä¿¡ãƒ‡ãƒãƒƒã‚°å¼·åŒ–)
6. [ãƒ­ã‚°ç®¡ç†ã¨å…±æœ‰æˆ¦ç•¥](#ãƒ­ã‚°ç®¡ç†ã¨å…±æœ‰æˆ¦ç•¥)
7. [ç’°å¢ƒå·®ç•°ã®æ¤œå‡º](#ç’°å¢ƒå·®ç•°ã®æ¤œå‡º)
8. [ãƒãƒ¼ãƒ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³](#ãƒãƒ¼ãƒ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³)
9. [ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«ã¨ç’°å¢ƒã®çµ±ä¸€](#ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«ã¨ç’°å¢ƒã®çµ±ä¸€)

## ã¯ã˜ã‚ã«

DailyFortuneãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®é€£æºã«ãŠã‘ã‚‹å•é¡Œã‚’æ—©æœŸã«ç™ºè¦‹ãƒ»è§£æ±ºã™ã‚‹ãŸã‚ã«ã€æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ‡ãƒãƒƒã‚°ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒå¿…è¦ã§ã™ã€‚ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ä¸»è¦ãªå•é¡Œç‰¹å®šã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨è§£æ±ºæˆ¦ç•¥ã‚’æä¾›ã—ã¾ã™ã€‚

---

## å•é¡Œã®åˆ‡ã‚Šåˆ†ã‘æˆ¦ç•¥

### ä¸‰å±¤ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚‹å•é¡Œç‰¹å®š

å•é¡Œã®æ ¹æœ¬åŸå› ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã®åŠ¹ç‡çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã—ã¦ã€ä¸‰å±¤ã«åˆ†ã‘ã¦è€ƒãˆã¾ã™ï¼š

1. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å±¤**
   - ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ç”Ÿæˆ
   - ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†
   - ãƒ‡ãƒ¼ã‚¿ã®æ•´å½¢

2. **é€šä¿¡å±¤**
   - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é€ä¿¡
   - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å—ä¿¡
   - CORSã€èªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼

3. **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å±¤**
   - ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å—ä¿¡ã¨è§£æ
   - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè¡Œ
   - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ç”Ÿæˆ

### å•é¡Œåˆ‡ã‚Šåˆ†ã‘ã®ãƒ‡ã‚£ã‚·ã‚¸ãƒ§ãƒ³ãƒ„ãƒªãƒ¼

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã€ä»¥ä¸‹ã®ãƒ•ãƒ­ãƒ¼ã§åˆ‡ã‚Šåˆ†ã‘ã‚’è¡Œã„ã¾ã™ï¼š

```
1. ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§æ­£ã—ãæ§‹ç¯‰ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
   â”œâ”€â”€ Yes â†’ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã«å±Šã„ã¦ã„ã‚‹ã‹ï¼Ÿ
   â”‚         â”œâ”€â”€ Yes â†’ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«å±Šã„ã¦ã„ã‚‹ã‹ï¼Ÿ
   â”‚         â”‚         â”œâ”€â”€ Yes â†’ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®å‡¦ç†ã¯æˆåŠŸã—ã¦ã„ã‚‹ã‹ï¼Ÿ
   â”‚         â”‚         â””â”€â”€ No  â†’ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®å—ä¿¡ãƒ­ã‚°ã‚’ç¢ºèª
   â”‚         â””â”€â”€ No  â†’ ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–ã§ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
   â””â”€â”€ No  â†’ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª
```

---

## ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ‡ãƒãƒƒã‚°å¼·åŒ–

### APIã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰è¿½åŠ 

`api.service.ts`ã«è©³ç´°ãªãƒ‡ãƒãƒƒã‚°ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```typescript
// api.service.ts ã«è¿½åŠ 
private isDebugMode = true; // ç’°å¢ƒå¤‰æ•°ã§åˆ¶å¾¡å¯èƒ½

private logRequest(config: AxiosRequestConfig) {
  if (!this.isDebugMode) return;
  
  console.group(`ğŸŒ API Request: ${config.method?.toUpperCase()} ${config.url}`);
  console.log('Headers:', config.headers);
  console.log('Params:', config.params);
  console.log('Data:', config.data);
  console.groupEnd();
}

private logResponse(response: AxiosResponse) {
  if (!this.isDebugMode) return;
  
  console.group(`âœ… API Response: ${response.status} ${response.config.method?.toUpperCase()} ${response.config.url}`);
  console.log('Data:', response.data);
  console.log('Headers:', response.headers);
  console.groupEnd();
}

private logError(error: any) {
  console.group(`âŒ API Error: ${error.config?.method?.toUpperCase()} ${error.config?.url}`);
  if (error.response) {
    console.log('Status:', error.response.status);
    console.log('Data:', error.response.data);
    console.log('Headers:', error.response.headers);
  } else if (error.request) {
    console.log('Request made but no response received');
    console.log(error.request);
  } else {
    console.log('Error:', error.message);
  }
  console.log('Config:', error.config);
  console.groupEnd();
}
```

ã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ã‚¿ãƒ¼ã«çµ„ã¿è¾¼ã¿ï¼š

```typescript
// ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ã‚¿ãƒ¼
this.api.interceptors.request.use(
  async (config) => {
    // æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰...
    this.logRequest(config);
    return config;
  },
  (error) => {
    this.logError(error);
    return Promise.reject(error);
  }
);

// ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ã‚¿ãƒ¼
this.api.interceptors.response.use(
  (response) => {
    this.logResponse(response);
    return response;
  },
  (error) => {
    this.logError(error);
    return Promise.reject(error);
  }
);
```

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã®å¼·åŒ–

ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ç‰¹å®šã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç¢ºå®Ÿã«ç›£è¦–ã™ã‚‹ãŸã‚ã®æ˜ç¤ºçš„ãªãƒ‡ãƒãƒƒã‚°ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ï¼š

```typescript
// é‡è¦ãªAPIã‚³ãƒ¼ãƒ«ã®å‰ã«è¿½åŠ 
console.log('%cğŸ” NETWORK DEBUG: ä»¥ä¸‹ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–ã§è¿½è·¡ã—ã¦ãã ã•ã„', 'color: blue; font-weight: bold');
console.log(`${method.toUpperCase()} ${url}`);
console.table({
  'Header Authorization': 'Bearer ...[token]',
  'Content-Type': 'application/json',
  'Request Body': JSON.stringify(data)
});
```

### Firebaseãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼

APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå‰ã®ãƒˆãƒ¼ã‚¯ãƒ³çŠ¶æ…‹ã®ãƒ­ã‚°è¨˜éŒ²ï¼š

```typescript
// api.service.tsã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ã‚¿ãƒ¼ã«è¿½åŠ 
const auth = getAuth();
const user = auth.currentUser;

if (user) {
  try {
    // ç¾åœ¨ã®ãƒˆãƒ¼ã‚¯ãƒ³æƒ…å ±ã‚’ãƒ­ã‚°
    const currentToken = await user.getIdTokenResult();
    console.group('ğŸ” Firebase Token Info');
    console.log('Token exists:', !!currentToken.token);
    console.log('Token length:', currentToken.token.length);
    console.log('Token expiration:', currentToken.expirationTime);
    console.log('Claims:', currentToken.claims);
    console.groupEnd();
    
    // ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æ€§ç¢ºèª
    const tokenAge = new Date(currentToken.expirationTime).getTime() - Date.now();
    if (tokenAge < 0) {
      console.warn('âš ï¸ Token is expired! Forcing refresh...');
      // å¼·åˆ¶æ›´æ–°
      const freshToken = await user.getIdToken(true);
      config.headers['Authorization'] = `Bearer ${freshToken}`;
    } else {
      console.log(`ğŸ” Token valid for ${Math.floor(tokenAge / 1000 / 60)} minutes`);
      config.headers['Authorization'] = `Bearer ${currentToken.token}`;
    }
  } catch (error) {
    console.error('ğŸš« Token retrieval error:', error);
  }
} else {
  console.warn('âš ï¸ No user logged in, request will be unauthorized');
}
```

---

## ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‡ãƒãƒƒã‚°å¼·åŒ–

### ãƒªã‚¯ã‚¨ã‚¹ãƒˆå—ä¿¡ãƒ­ã‚°ã®å¼·åŒ–

`server/src/index.ts` ã¾ãŸã¯ Expressè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«è©³ç´°ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚®ãƒ³ã‚°ã‚’è¿½åŠ ï¼š

```typescript
// ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚®ãƒ³ã‚°ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
app.use((req, res, next) => {
  // é‡è¦ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆæƒ…å ±ã‚’ãƒ­ã‚°
  console.group(`ğŸ“¥ Request: ${req.method} ${req.originalUrl}`);
  console.log('Headers:', {
    'content-type': req.headers['content-type'],
    'authorization': req.headers['authorization'] ? 'Bearer [exists]' : 'None',
    'user-agent': req.headers['user-agent']
  });
  
  // POST/PUT/PATCHãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒœãƒ‡ã‚£ã‚’ãƒ­ã‚°
  if (['POST', 'PUT', 'PATCH'].includes(req.method) && req.body) {
    console.log('Body:', req.body);
  }
  
  // GETãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ­ã‚°
  if (req.method === 'GET' && Object.keys(req.query).length > 0) {
    console.log('Query:', req.query);
  }
  
  console.log('Params:', req.params);
  console.groupEnd();
  
  // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒ­ã‚°
  const originalSend = res.send;
  res.send = function(body) {
    console.group(`ğŸ“¤ Response: ${req.method} ${req.originalUrl} - ${res.statusCode}`);
    
    try {
      // JSONãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã¿ãƒ­ã‚°
      if (res.getHeader('content-type')?.includes('application/json')) {
        const data = typeof body === 'string' ? JSON.parse(body) : body;
        console.log('Data:', data);
      } else {
        console.log('Response type:', res.getHeader('content-type'));
      }
    } catch (e) {
      console.log('Raw response (not JSON):', body);
    }
    
    console.groupEnd();
    return originalSend.call(this, body);
  };
  
  next();
});
```

### èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ãƒ‡ãƒãƒƒã‚°å¼·åŒ–

`auth.middleware.ts`ã«ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã‚’å¼·åŒ–ã—ã€èªè¨¼ã®æµã‚Œã‚’è©³ç´°ã«è¿½è·¡ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ï¼š

```typescript
// server/src/middleware/auth.middleware.ts
export const authenticate = async (req: Request, res: Response, next: NextFunction) => {
  try {
    console.group('ğŸ”‘ Auth Middleware');
    
    const authHeader = req.headers.authorization;
    console.log('Authorization header exists:', !!authHeader);
    
    if (!authHeader || !authHeader.startsWith('Bearer ')) {
      console.log('âŒ No Bearer token found');
      console.groupEnd();
      return res.status(401).json({ message: 'Unauthorized - No token provided' });
    }
    
    const token = authHeader.split('Bearer ')[1];
    console.log('Token extracted, length:', token.length);
    
    try {
      const decodedToken = await admin.auth().verifyIdToken(token);
      console.log('âœ… Token verified successfully');
      console.log('User ID:', decodedToken.uid);
      console.log('Email:', decodedToken.email);
      console.log('Role claims:', decodedToken.role || 'No role claim');
      
      req.user = decodedToken;
      console.groupEnd();
      next();
    } catch (verifyError) {
      console.log('âŒ Token verification failed:', verifyError.message);
      console.groupEnd();
      return res.status(401).json({ message: 'Unauthorized - Invalid token' });
    }
  } catch (error) {
    console.log('âŒ Unexpected error in auth middleware:', error);
    console.groupEnd();
    return res.status(500).json({ message: 'Internal server error' });
  }
};
```

### ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ­ã‚°ã®å¼·åŒ–

ãƒ«ãƒ¼ãƒˆãŒæ­£ã—ãç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ãŸã‚ã®ãƒ­ã‚°ã‚’è¿½åŠ ï¼š

```typescript
// server/src/index.ts ã®èµ·å‹•æ™‚ã«è¿½åŠ 
console.log('ğŸ“š Registered Routes:');
// Express Routerã®å…¨ãƒ«ãƒ¼ãƒˆã‚’ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹é–¢æ•°
function printRoutes(app) {
  function print(path, layer) {
    if (layer.route) {
      layer.route.stack.forEach(print.bind(null, path.concat(split(layer.route.path))));
    } else if (layer.name === 'router' && layer.handle.stack) {
      layer.handle.stack.forEach(print.bind(null, path.concat(split(layer.regexp))));
    } else if (layer.method) {
      console.log('%s %s', layer.method.toUpperCase(), path.concat(split(layer.regexp)).filter(Boolean).join('/'));
    }
  }

  function split(thing) {
    if (typeof thing === 'string') {
      return thing.split('/');
    } else if (thing.fast_slash) {
      return [''];
    } else {
      const match = thing.toString()
        .replace('\\/?', '')
        .replace('(?=\\/|$)', '$')
        .match(/^\/\^((?:\\[.*+?^${}()|[\]\\\/]|[^.*+?^${}()|[\]\\\/])*)\$\//);
      return match ?
        match[1].replace(/\\(.)/g, '$1').split('/') :
        ['<complex>'];
    }
  }

  app._router.stack.forEach(print.bind(null, []));
}

printRoutes(app);
```

---

## APIé€šä¿¡ãƒ‡ãƒãƒƒã‚°å¼·åŒ–

### APIãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ã®å°å…¥

APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã‚­ãƒ£ãƒ—ãƒãƒ£ã¨åˆ†æã®ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã‚’å°å…¥ã—ã¾ã™ï¼š

1. **å†…éƒ¨ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢**

```typescript
// server/src/middleware/api-monitor.middleware.ts
export const apiMonitor = (req: Request, res: Response, next: NextFunction) => {
  const startTime = Date.now();
  const requestId = uuidv4().substr(0, 8);
  
  // ãƒªã‚¯ã‚¨ã‚¹ãƒˆæƒ…å ±ã‚’ä¸€æ™‚ä¿å­˜
  const requestInfo = {
    id: requestId,
    method: req.method,
    url: req.originalUrl,
    headers: req.headers,
    body: req.body,
    startTime,
    clientIP: req.ip,
    userAgent: req.headers['user-agent'] || 'Unknown'
  };
  
  // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®é–‹å§‹ã‚’ãƒ­ã‚°
  console.log(`[REQ:${requestId}] ${req.method} ${req.originalUrl} started`);
  
  // ãƒ¡ãƒ¢ãƒªã«ä¿å­˜ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯Redisãªã©ã‚’ä½¿ç”¨ï¼‰
  apiRequests.set(requestId, requestInfo);
  
  // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ•ãƒƒã‚¯
  const originalEnd = res.end;
  res.end = function(chunk, encoding) {
    const endTime = Date.now();
    const duration = endTime - startTime;
    
    // ãƒ¬ã‚¹ãƒãƒ³ã‚¹æƒ…å ±ã‚’è¿½åŠ 
    const fullRequestInfo = {
      ...requestInfo,
      statusCode: res.statusCode,
      duration,
      responseHeaders: res.getHeaders(),
      responseBody: res.locals.responseBody, // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã™ã‚‹ã«ã¯è¿½åŠ ã®å‡¦ç†ãŒå¿…è¦
      endTime
    };
    
    // ãƒ­ã‚°ã«è¨˜éŒ²
    console.log(`[RES:${requestId}] ${req.method} ${req.originalUrl} completed in ${duration}ms with status ${res.statusCode}`);
    
    // é…ã„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è­¦å‘Š
    if (duration > 1000) {
      console.warn(`âš ï¸ Slow API: ${req.method} ${req.originalUrl} took ${duration}ms`);
    }
    
    // ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è­¦å‘Š
    if (res.statusCode >= 400) {
      console.error(`âŒ API Error: ${req.method} ${req.originalUrl} returned ${res.statusCode}`);
      // ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’ãƒ­ã‚°ã«è¨˜éŒ²
    }
    
    // çµæœã‚’ä¿å­˜ï¼ˆå®Ÿè£…ã«ã‚ˆã£ã¦ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ï¼‰
    apiRequests.set(requestId, fullRequestInfo);
    
    // ä¸€å®šæ™‚é–“çµŒéå¾Œã«ãƒ¡ãƒ¢ãƒªã‹ã‚‰ã‚¯ãƒªã‚¢
    setTimeout(() => {
      apiRequests.delete(requestId);
    }, 3600000); // 1æ™‚é–“å¾Œ
    
    return originalEnd.apply(res, arguments);
  };
  
  // ãƒªã‚¯ã‚¨ã‚¹ãƒˆIDã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã«è¿½åŠ 
  res.setHeader('X-Request-ID', requestId);
  next();
};

// ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•æ™‚ã«åˆæœŸåŒ–
const apiRequests = new Map();
```

2. **APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå¯è¦–åŒ–ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ** (é–‹ç™ºç’°å¢ƒã®ã¿)

```typescript
// é–‹ç™ºç’°å¢ƒã®ã¿ã§æœ‰åŠ¹ãªãƒ‡ãƒãƒƒã‚°UIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
if (process.env.NODE_ENV === 'development') {
  app.get('/_debug/api-monitor', (req, res) => {
    const requestsArray = Array.from(apiRequests.values()).sort((a, b) => b.startTime - a.startTime);
    res.render('api-monitor', { requests: requestsArray });
  });
  
  app.get('/_debug/api-monitor/:id', (req, res) => {
    const requestInfo = apiRequests.get(req.params.id);
    if (!requestInfo) {
      return res.status(404).send('Request not found');
    }
    res.render('api-monitor-detail', { request: requestInfo });
  });
}
```

### APIãƒ•ãƒ­ãƒ¼ã®è¦–è¦šåŒ–

é–‹ç™ºç’°å¢ƒã§ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¾ã§ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ãƒ­ãƒ¼ã‚’è¦–è¦šåŒ–ã™ã‚‹ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ„ãƒ¼ãƒ«ã‚’å®Ÿè£…ï¼š

```typescript
// ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®api.service.tsã«è¿½åŠ 
private visualizeRequestFlow(config: AxiosRequestConfig, requestId: string) {
  if (!this.isDebugMode) return;
  
  console.log(
    `%c${requestId} â†’ [FE] â†’ [NET] â†’ [BE] â†’ [DB] â†’ [BE] â†’ [NET] â†’ [FE]`,
    'font-family: monospace; font-size: 14px; color: gray'
  );
  
  // ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡æ™‚
  console.log(
    `%c${requestId} â†’ %c[FE] %câ†’ [NET] â†’ [BE] â†’ [DB] â†’ [BE] â†’ [NET] â†’ [FE]`,
    'font-family: monospace; font-size: 14px; color: gray',
    'font-family: monospace; font-size: 14px; color: blue; font-weight: bold',
    'font-family: monospace; font-size: 14px; color: gray'
  );
  
  // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§ã®å®Œäº†æ™‚ã®è¡¨ç¤ºã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ã‚¿ãƒ¼ã§å¯¾å¿œ
}

// ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ã‚¿ãƒ¼ã§ã®ãƒ•ãƒ­ãƒ¼å®Œäº†è¡¨ç¤º
private visualizeResponseFlow(response: AxiosResponse, requestId: string) {
  if (!this.isDebugMode) return;
  
  console.log(
    `%c${requestId} â†’ %c[FE] â†’ [NET] â†’ [BE] â†’ [DB] â†’ [BE] â†’ [NET] %câ†’ [FE]`,
    'font-family: monospace; font-size: 14px; color: gray',
    'font-family: monospace; font-size: 14px; color: gray',
    'font-family: monospace; font-size: 14px; color: green; font-weight: bold'
  );
}
```

### ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆå•é¡Œã®æ¤œå‡º

CORSå•é¡Œã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã®ç‰¹æ®Šãªãƒ­ã‚®ãƒ³ã‚°æ©Ÿèƒ½ã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«è¿½åŠ ï¼š

```typescript
// server/src/middleware/cors-debug.middleware.ts
export const corsDebugMiddleware = (req: Request, res: Response, next: NextFunction) => {
  const origin = req.headers.origin;
  
  console.log('ğŸŒ CORS Check: Request origin =', origin || 'None (Same origin or no origin header)');
  console.log('ğŸŒ CORS Check: Current allowed origins =', process.env.CORS_ALLOWED_ORIGINS?.split(',') || 'All allowed');
  
  // ãƒ—ãƒªãƒ•ãƒ©ã‚¤ãƒˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã®è©³ç´°ãƒ­ã‚°
  if (req.method === 'OPTIONS') {
    console.group('ğŸŒ CORS Preflight Request');
    console.log('Request headers:', {
      'origin': req.headers.origin,
      'access-control-request-method': req.headers['access-control-request-method'],
      'access-control-request-headers': req.headers['access-control-request-headers']
    });
    console.groupEnd();
  }
  
  next();
  
  // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®CORSãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ãƒ­ã‚°
  res.on('finish', () => {
    const corsHeaders = {
      'access-control-allow-origin': res.getHeader('access-control-allow-origin'),
      'access-control-allow-methods': res.getHeader('access-control-allow-methods'),
      'access-control-allow-headers': res.getHeader('access-control-allow-headers'),
      'access-control-allow-credentials': res.getHeader('access-control-allow-credentials')
    };
    
    console.log('ğŸŒ CORS Response Headers:', corsHeaders);
    
    // CORSã‚¨ãƒ©ãƒ¼ã®å¯èƒ½æ€§ã‚’æ¤œå‡º
    if (origin && !corsHeaders['access-control-allow-origin']) {
      console.warn('âš ï¸ Potential CORS issue: Origin not allowed in response headers');
    }
  });
};
```

---

## ãƒ­ã‚°ç®¡ç†ã¨å…±æœ‰æˆ¦ç•¥

### æ§‹é€ åŒ–ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

JSONãƒ™ãƒ¼ã‚¹ã®æ§‹é€ åŒ–ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’å°å…¥ã—ã¦ãƒ­ã‚°ã®æ¤œç´¢æ€§ã¨åˆ†æã‚’å‘ä¸Šã•ã›ã¾ã™ï¼š

```typescript
// server/src/utils/logger.ts
import winston from 'winston';

const logger = winston.createLogger({
  level: process.env.LOG_LEVEL || 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.json()
  ),
  defaultMeta: { service: 'daily-fortune' },
  transports: [
    new winston.transports.Console({
      format: winston.format.combine(
        winston.format.colorize(),
        winston.format.printf(info => {
          const { timestamp, level, message, ...rest } = info;
          return `${timestamp} [${level}]: ${message} ${Object.keys(rest).length ? JSON.stringify(rest) : ''}`;
        })
      )
    }),
    new winston.transports.File({ filename: 'logs/error.log', level: 'error' }),
    new winston.transports.File({ filename: 'logs/combined.log' })
  ]
});

// ãƒªã‚¯ã‚¨ã‚¹ãƒˆIDä»˜ãã®ãƒ­ã‚¬ãƒ¼å–å¾—é–¢æ•°
export function getRequestLogger(requestId: string) {
  return {
    info: (message: string, meta = {}) => {
      logger.info(message, { requestId, ...meta });
    },
    warn: (message: string, meta = {}) => {
      logger.warn(message, { requestId, ...meta });
    },
    error: (message: string, meta = {}) => {
      logger.error(message, { requestId, ...meta });
    },
    debug: (message: string, meta = {}) => {
      logger.debug(message, { requestId, ...meta });
    }
  };
}

export default logger;
```

### ãƒ­ã‚°ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½

ãƒ‡ãƒãƒƒã‚°ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸­ã®ãƒ­ã‚°ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã§ãã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ï¼š

```typescript
// ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ãƒ‡ãƒãƒƒã‚°ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
export const exportLogs = (identifier = 'debug-logs') => {
  // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã‚’ä¸Šæ›¸ã
  if (!window._logHistory) {
    window._logHistory = [];
    
    // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ¡ã‚½ãƒƒãƒ‰ã®å…ƒã®å®Ÿè£…ã‚’ä¿å­˜
    const originalConsole = {
      log: console.log,
      error: console.error,
      warn: console.warn,
      info: console.info
    };
    
    // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒ­ã‚°è¨˜éŒ²ã¨å…ƒã®å‹•ä½œã‚’ä¸¡æ–¹è¡Œã†ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ä¸Šæ›¸ã
    Object.keys(originalConsole).forEach(method => {
      console[method] = function(...args) {
        // å…ƒã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã‚’å®Ÿè¡Œ
        originalConsole[method].apply(console, args);
        
        // ãƒ­ã‚°ã‚’è¨˜éŒ²
        window._logHistory.push({
          type: method,
          args: args.map(arg => {
            try {
              // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ–‡å­—åˆ—åŒ–
              return typeof arg === 'object' ? JSON.stringify(arg) : String(arg);
            } catch (e) {
              return '[Unstringifiable Object]';
            }
          }),
          timestamp: new Date().toISOString()
        });
      };
    });
  }
  
  // ãƒ­ã‚°ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
  const logBlob = new Blob(
    [JSON.stringify(window._logHistory, null, 2)], 
    { type: 'application/json' }
  );
  
  const url = URL.createObjectURL(logBlob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `${identifier}-${new Date().toISOString()}.json`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  
  return `Exported ${window._logHistory.length} log entries`;
};

// é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã®ä½¿ç”¨ä¾‹:
// > exportLogs('api-debug-session')
```

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã‚‚åŒæ§˜ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã‚’å®Ÿè£…ï¼š

```typescript
// server/src/utils/log-exporter.ts
import fs from 'fs';
import path from 'path';

// æœ€è¿‘ã®ãƒ­ã‚°ã‚¨ãƒ³ãƒˆãƒªã‚’ä¿æŒã™ã‚‹ãƒ¡ãƒ¢ãƒªãƒãƒƒãƒ•ã‚¡
const logBuffer = [];
const MAX_BUFFER_SIZE = 1000;

// ãƒ­ã‚°ãƒãƒƒãƒ•ã‚¡ã«è¿½åŠ 
export function addToLogBuffer(entry) {
  logBuffer.push({
    ...entry,
    timestamp: new Date().toISOString()
  });
  
  // ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã‚’åˆ¶é™
  if (logBuffer.length > MAX_BUFFER_SIZE) {
    logBuffer.shift();
  }
}

// ãƒ­ã‚°ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
export function exportLogs(identifier = 'server-logs') {
  const filename = `${identifier}-${new Date().toISOString()}.json`;
  const logDir = path.join(process.cwd(), 'logs', 'exports');
  
  // ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆï¼ˆå­˜åœ¨ã—ãªã„å ´åˆï¼‰
  if (!fs.existsSync(logDir)) {
    fs.mkdirSync(logDir, { recursive: true });
  }
  
  // ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿
  fs.writeFileSync(
    path.join(logDir, filename),
    JSON.stringify(logBuffer, null, 2)
  );
  
  return {
    filename,
    entryCount: logBuffer.length,
    path: path.join(logDir, filename)
  };
}

// APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç”¨ã®é–¢æ•°
export function exportLogsHandler(req, res) {
  try {
    const result = exportLogs(req.query.identifier || 'api-logs');
    res.json({
      success: true,
      ...result
    });
  } catch (error) {
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
}
```

### ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®è‡ªå‹•åˆ†æ

ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’è‡ªå‹•çš„ã«åˆ†æã—ã¦ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡ºã™ã‚‹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼š

```typescript
// server/src/utils/error-analyzer.ts
import fs from 'fs';
import path from 'path';

// ã‚¨ãƒ©ãƒ¼ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æ
export function analyzeErrorPatterns() {
  const errorLogPath = path.join(process.cwd(), 'logs', 'error.log');
  
  if (!fs.existsSync(errorLogPath)) {
    return {
      count: 0,
      patterns: [],
      message: 'No error logs found'
    };
  }
  
  // ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’èª­ã¿è¾¼ã¿
  const content = fs.readFileSync(errorLogPath, 'utf8');
  const lines = content.split('\n').filter(line => line.trim());
  
  // ã‚¨ãƒ©ãƒ¼ã‚’è§£æ
  const errors = lines.map(line => {
    try {
      return JSON.parse(line);
    } catch (e) {
      return { raw: line };
    }
  });
  
  // ã‚¨ãƒ©ãƒ¼ã‚«ã‚¦ãƒ³ãƒˆ
  const errorTypes = {};
  const endpoints = {};
  const statusCodes = {};
  
  errors.forEach(error => {
    // ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
    const type = error.error || error.message || 'unknown';
    errorTypes[type] = (errorTypes[type] || 0) + 1;
    
    // ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ã‚«ã‚¦ãƒ³ãƒˆ
    if (error.url || error.path) {
      const endpoint = error.url || error.path;
      endpoints[endpoint] = (endpoints[endpoint] || 0) + 1;
    }
    
    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
    if (error.statusCode || error.status) {
      const status = error.statusCode || error.status;
      statusCodes[status] = (statusCodes[status] || 0) + 1;
    }
  });
  
  // çµæœã‚’ç”Ÿæˆ
  return {
    count: errors.length,
    topErrorTypes: Object.entries(errorTypes)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 5),
    topEndpoints: Object.entries(endpoints)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 5),
    topStatusCodes: Object.entries(statusCodes)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 5),
    recentErrors: errors.slice(-10)
  };
}
```

---

## ç’°å¢ƒå·®ç•°ã®æ¤œå‡º

### ç’°å¢ƒæ¤œè¨¼ãƒ„ãƒ¼ãƒ«

ç’°å¢ƒé–“ã®å·®ç•°ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆï¼š

```typescript
// scripts/verify-environment.ts
import fs from 'fs';
import path from 'path';
import dotenv from 'dotenv';
import axios from 'axios';

// å¿…é ˆç’°å¢ƒå¤‰æ•°ãƒªã‚¹ãƒˆ
const REQUIRED_ENV_VARS = [
  'FIREBASE_SERVICE_ACCOUNT_PATH',
  'FIREBASE_PROJECT_ID',
  'MONGODB_URI',
  'API_PORT',
  'CORS_ALLOWED_ORIGINS',
  'JWT_SECRET'
];

// ç’°å¢ƒåˆ¥ã®æƒ³å®šå€¤ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
const EXPECTED_VALUES = {
  development: {
    'API_PORT': '8080',
    'LOG_LEVEL': 'debug'
  },
  production: {
    'API_PORT': '8080',
    'LOG_LEVEL': 'info'
  }
};

async function verifyEnvironment() {
  console.log('ğŸ” Verifying environment...');
  const issues = [];
  
  // .envãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª
  const envPath = path.join(process.cwd(), '.env');
  if (!fs.existsSync(envPath)) {
    issues.push({
      level: 'critical',
      message: '.env file not found',
      fix: 'Create .env file with required variables'
    });
    // è‡´å‘½çš„ãªå•é¡ŒãŒã‚ã‚Œã°æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³
    return { valid: false, issues };
  }
  
  // ç’°å¢ƒå¤‰æ•°ãƒ­ãƒ¼ãƒ‰
  const envVars = dotenv.parse(fs.readFileSync(envPath));
  
  // å¿…é ˆç’°å¢ƒå¤‰æ•°ãƒã‚§ãƒƒã‚¯
  for (const variable of REQUIRED_ENV_VARS) {
    if (!envVars[variable]) {
      issues.push({
        level: 'critical',
        message: `Missing required env var: ${variable}`,
        fix: `Add ${variable} to .env file`
      });
    }
  }
  
  // Firebaseã‚­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª
  if (envVars.FIREBASE_SERVICE_ACCOUNT_PATH) {
    if (!fs.existsSync(envVars.FIREBASE_SERVICE_ACCOUNT_PATH)) {
      issues.push({
        level: 'critical',
        message: `Firebase service account file not found at ${envVars.FIREBASE_SERVICE_ACCOUNT_PATH}`,
        fix: 'Check the path or download the service account file'
      });
    }
  }
  
  // MongoDBæ¥ç¶šç¢ºèª
  if (envVars.MONGODB_URI) {
    try {
      // MongoDBã«å®Ÿéš›ã«æ¥ç¶šã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ã“ã“ã«è¿½åŠ 
      console.log('Checking MongoDB connection...');
      // ...
    } catch (error) {
      issues.push({
        level: 'critical',
        message: `Failed to connect to MongoDB: ${error.message}`,
        fix: 'Check MongoDB URI and credentials'
      });
    }
  }
  
  // æƒ³å®šå€¤ã¨ã®æ¯”è¼ƒ
  const nodeEnv = process.env.NODE_ENV || 'development';
  if (EXPECTED_VALUES[nodeEnv]) {
    for (const [key, value] of Object.entries(EXPECTED_VALUES[nodeEnv])) {
      if (envVars[key] !== value) {
        issues.push({
          level: 'warning',
          message: `Env var ${key} has unexpected value. Got: ${envVars[key]}, Expected: ${value}`,
          fix: `Set ${key}=${value} in .env for ${nodeEnv} environment`
        });
      }
    }
  }
  
  // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
  try {
    const port = envVars.API_PORT || '8080';
    const response = await axios.get(`http://localhost:${port}/health`);
    if (response.status !== 200) {
      issues.push({
        level: 'warning',
        message: `Health check failed: ${response.status} ${response.statusText}`,
        fix: 'Check if backend is running correctly'
      });
    }
  } catch (error) {
    issues.push({
      level: 'warning',
      message: `Health check failed: ${error.message}`,
      fix: 'Make sure backend is running'
    });
  }
  
  // çµæœ
  return {
    valid: issues.filter(i => i.level === 'critical').length === 0,
    issues
  };
}

// å®Ÿè¡Œ
verifyEnvironment().then(result => {
  console.log('Environment verification complete:');
  console.log(`Valid: ${result.valid}`);
  
  if (result.issues.length > 0) {
    console.log('Issues found:');
    result.issues.forEach(issue => {
      console.log(`[${issue.level.toUpperCase()}] ${issue.message}`);
      console.log(`    Fix: ${issue.fix}`);
    });
  }
});
```

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«è©³ç´°ãªãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ ï¼š

```typescript
// server/src/routes/health.routes.ts
import { Router } from 'express';
import mongoose from 'mongoose';
import admin from 'firebase-admin';
import os from 'os';

const router = Router();

// åŸºæœ¬ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
router.get('/', async (req, res) => {
  const isDbConnected = mongoose.connection.readyState === 1;
  
  res.json({
    status: 'ok',
    timestamp: new Date().toISOString(),
    uptime: process.uptime(),
    database: isDbConnected ? 'connected' : 'disconnected',
    environment: process.env.NODE_ENV || 'development'
  });
});

// è©³ç´°ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ï¼ˆé–‹ç™ºç’°å¢ƒå°‚ç”¨ï¼‰
router.get('/detailed', async (req, res) => {
  if (process.env.NODE_ENV !== 'development') {
    return res.status(403).json({ error: 'Detailed health check only available in development environment' });
  }
  
  try {
    // DBæ¥ç¶šçŠ¶æ…‹
    const dbState = {
      connected: mongoose.connection.readyState === 1,
      host: mongoose.connection.host,
      name: mongoose.connection.name,
      models: Object.keys(mongoose.models)
    };
    
    // Firebaseæ¥ç¶šçŠ¶æ…‹
    let firebaseState = { initialized: false };
    try {
      const app = admin.app();
      firebaseState = {
        initialized: true,
        name: app.name,
        projectId: process.env.FIREBASE_PROJECT_ID
      };
    } catch (e) {
      firebaseState.error = e.message;
    }
    
    // ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹
    const systemInfo = {
      platform: process.platform,
      nodeVersion: process.version,
      memory: {
        total: os.totalmem(),
        free: os.freemem(),
        processUsage: process.memoryUsage()
      },
      cpus: os.cpus().length,
      loadAvg: os.loadavg()
    };
    
    // ã‚¢ãƒ—ãƒªã®çŠ¶æ…‹
    const appState = {
      uptime: process.uptime(),
      environment: process.env.NODE_ENV || 'development',
      port: process.env.API_PORT || 8080,
      corsOrigins: process.env.CORS_ALLOWED_ORIGINS?.split(',') || []
    };
    
    res.json({
      status: 'ok',
      timestamp: new Date().toISOString(),
      database: dbState,
      firebase: firebaseState,
      system: systemInfo,
      application: appState
    });
  } catch (error) {
    res.status(500).json({
      status: 'error',
      error: error.message,
      timestamp: new Date().toISOString()
    });
  }
});

export default router;
```

---

## ãƒãƒ¼ãƒ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³

### ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

é–‹ç™ºãƒãƒ¼ãƒ ã§ã‚¨ãƒ©ãƒ¼ã‚’å…±æœ‰ã—ã‚„ã™ãã™ã‚‹ãŸã‚ã®ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆæ©Ÿèƒ½ï¼š

```typescript
// ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ‡ãƒãƒƒã‚°ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã«è¿½åŠ 
export function generateErrorReport() {
  const reportData = {
    timestamp: new Date().toISOString(),
    userAgent: navigator.userAgent,
    url: window.location.href,
    // æœ€è¿‘ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°
    recentLogs: window._logHistory?.slice(-20) || [],
    // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ä¸€éƒ¨ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆæ©Ÿå¯†æƒ…å ±ã¯é™¤å¤–ï¼‰
    storage: {
      hasToken: !!localStorage.getItem('token'),
      loggedIn: !!localStorage.getItem('loggedIn'),
      // æ©Ÿå¯†æƒ…å ±ã¯å«ã‚ãªã„
    },
    // ãã®ä»–ã®ç’°å¢ƒæƒ…å ±
    environment: {
      screenSize: `${window.innerWidth}x${window.innerHeight}`,
      language: navigator.language,
      platform: navigator.platform
    }
  };
  
  // ãƒ¬ãƒãƒ¼ãƒˆã®æ–‡å­—åˆ—åŒ–
  const reportString = 
`## ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆ
**æ—¥æ™‚**: ${reportData.timestamp}
**URL**: ${reportData.url}
**ãƒ–ãƒ©ã‚¦ã‚¶**: ${reportData.userAgent}

### ç’°å¢ƒæƒ…å ±
- **ç”»é¢ã‚µã‚¤ã‚º**: ${reportData.environment.screenSize}
- **è¨€èª**: ${reportData.environment.language}
- **ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **: ${reportData.environment.platform}

### èªè¨¼çŠ¶æ…‹
- **ãƒˆãƒ¼ã‚¯ãƒ³å­˜åœ¨**: ${reportData.storage.hasToken}
- **ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹**: ${reportData.storage.loggedIn}

### æœ€è¿‘ã®ãƒ­ã‚°
\`\`\`
${reportData.recentLogs.map(log => 
  `[${log.timestamp}] [${log.type}] ${log.args.join(' ')}`
).join('\n')}
\`\`\`
`;

  console.info('ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸ:');
  console.info(reportString);
  
  // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
  navigator.clipboard.writeText(reportString)
    .then(() => console.info('ãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ'))
    .catch(e => console.error('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ:', e));
  
  return reportString;
}
```

### å³æ™‚å…±æœ‰ã‚·ã‚¹ãƒ†ãƒ 

ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å•é¡Œã‚’å³åº§ã«å…±æœ‰ã§ãã‚‹ã‚·ã‚¹ãƒ†ãƒ ï¼š

```typescript
// GIST APIã‚’ä½¿ç”¨ã—ãŸå…±æœ‰æ©Ÿèƒ½
export async function shareDebugSession(title = 'ãƒ‡ãƒãƒƒã‚°ã‚»ãƒƒã‚·ãƒ§ãƒ³') {
  // APIã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãŒå¿…è¦ãªå ´åˆã¯ã€å®‰å…¨ãªæ–¹æ³•ã§å–å¾—ã™ã‚‹ã‹ã€
  // é–‹ç™ºç’°å¢ƒç”¨ã®é™å®šçš„ãªãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ç”¨
  const API_TOKEN = process.env.GIST_API_TOKEN;
  if (!API_TOKEN) {
    console.error('GIST API TOKENãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
    return null;
  }
  
  // ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  const logs = window._logHistory || [];
  const lastLogs = logs.slice(-100); // æœ€æ–°ã®100ä»¶ã®ã¿
  
  // ç’°å¢ƒæƒ…å ±ã‚’å–å¾—
  const envInfo = {
    userAgent: navigator.userAgent,
    url: window.location.href,
    timestamp: new Date().toISOString(),
    screenSize: `${window.innerWidth}x${window.innerHeight}`
  };
  
  // GISTã«æŠ•ç¨¿ã™ã‚‹å†…å®¹ã‚’ä½œæˆ
  const content = {
    description: `${title} - ${envInfo.timestamp}`,
    public: false,
    files: {
      'debug-info.md': {
        content: `# ${title}\n\n## ç’°å¢ƒæƒ…å ±\n\`\`\`json\n${JSON.stringify(envInfo, null, 2)}\n\`\`\`\n\n## èªè¨¼çŠ¶æ…‹\n- ãƒˆãƒ¼ã‚¯ãƒ³å­˜åœ¨: ${!!localStorage.getItem('token')}\n`
      },
      'console-logs.json': {
        content: JSON.stringify(lastLogs, null, 2)
      }
    }
  };
  
  try {
    // GitHub GIST APIã‚’ä½¿ç”¨ã—ã¦å…±æœ‰
    const response = await fetch('https://api.github.com/gists', {
      method: 'POST',
      headers: {
        'Authorization': `token ${API_TOKEN}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(content)
    });
    
    const data = await response.json();
    
    if (data.html_url) {
      console.info(`ãƒ‡ãƒãƒƒã‚°ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å…±æœ‰ã—ã¾ã—ãŸ: ${data.html_url}`);
      return data.html_url;
    } else {
      console.error('GISTã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ:', data);
      return null;
    }
  } catch (error) {
    console.error('ãƒ‡ãƒãƒƒã‚°ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å…±æœ‰ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
    return null;
  }
}
```

---

## ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«ã¨ç’°å¢ƒã®çµ±ä¸€

### ãƒ‡ãƒãƒƒã‚°ã‚³ãƒãƒ³ãƒ‰ã‚»ãƒƒãƒˆ

é–‹ç™ºç’°å¢ƒã§ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒãƒƒã‚°ã‚³ãƒãƒ³ãƒ‰ã‚»ãƒƒãƒˆã‚’å®šç¾©ã—ã€ãƒãƒ¼ãƒ é–“ã§å…±æœ‰ã—ã¾ã™ï¼š

```typescript
// ãƒ‡ãƒãƒƒã‚°ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’å…¬é–‹
window.DF = {
  // APIãƒ‡ãƒãƒƒã‚°
  api: {
    // APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¿½è·¡
    traceRequest: (method, url, data = null) => {
      const requestId = Math.random().toString(36).substring(2, 8);
      console.group(`ğŸ” API Request Trace [${requestId}]`);
      console.log(`${method.toUpperCase()} ${url}`);
      if (data) console.log('Request data:', data);
      console.groupEnd();
      
      return requestId; // ãƒˆãƒ¬ãƒ¼ã‚¹ç”¨ID
    },
    
    // ãƒˆãƒ¬ãƒ¼ã‚¹IDã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¨˜éŒ²
    traceResponse: (requestId, status, data) => {
      console.group(`âœ… API Response [${requestId}]`);
      console.log(`Status: ${status}`);
      console.log('Response data:', data);
      console.groupEnd();
    },
    
    // ãƒˆãƒ¬ãƒ¼ã‚¹IDã§ã‚¨ãƒ©ãƒ¼ã‚’è¨˜éŒ²
    traceError: (requestId, error) => {
      console.group(`âŒ API Error [${requestId}]`);
      console.error(error);
      console.groupEnd();
    },
    
    // èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œè¨¼
    checkAuth: async () => {
      const auth = window.firebase.auth();
      const user = auth.currentUser;
      
      if (!user) {
        console.log('âŒ No user logged in');
        return false;
      }
      
      try {
        const token = await user.getIdToken();
        console.log(`âœ… Valid token: ${token.substring(0, 10)}...`);
        
        // ãƒˆãƒ¼ã‚¯ãƒ³è©³ç´°
        const tokenResult = await user.getIdTokenResult();
        console.log('Token claims:', tokenResult.claims);
        console.log('Token expiration:', new Date(tokenResult.expirationTime));
        
        return true;
      } catch (error) {
        console.error('âŒ Token error:', error);
        return false;
      }
    },
    
    // ãƒ•ã‚©ãƒ¼ã‚¹ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³
    forceRefreshToken: async () => {
      const auth = window.firebase.auth();
      const user = auth.currentUser;
      
      if (!user) {
        console.log('âŒ No user logged in');
        return null;
      }
      
      try {
        const token = await user.getIdToken(true);
        console.log(`âœ… Token refreshed: ${token.substring(0, 10)}...`);
        return token;
      } catch (error) {
        console.error('âŒ Token refresh error:', error);
        return null;
      }
    }
  },
  
  // ãƒ­ã‚°ç®¡ç†
  logs: {
    exportLogs,
    generateErrorReport,
    shareDebugSession,
    
    // ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢
    clear: () => {
      if (window._logHistory) {
        window._logHistory = [];
      }
      console.clear();
      console.log('âœ¨ Logs cleared');
    }
  },
  
  // ç’°å¢ƒæƒ…å ±
  env: {
    // ç’°å¢ƒæƒ…å ±ã‚’è¡¨ç¤º
    info: () => {
      console.group('ğŸ”§ Environment Info');
      console.log('App version:', process.env.REACT_APP_VERSION || 'Unknown');
      console.log('Environment:', process.env.NODE_ENV);
      console.log('API URL:', process.env.REACT_APP_API_URL);
      console.log('Firebase config:', {
        projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,
        authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN
      });
      console.groupEnd();
    },
    
    // ãƒ–ãƒ©ã‚¦ã‚¶æƒ…å ±ã‚’è¡¨ç¤º
    browser: () => {
      console.group('ğŸŒ Browser Info');
      console.log('User agent:', navigator.userAgent);
      console.log('Language:', navigator.language);
      console.log('Platform:', navigator.platform);
      console.log('Screen size:', `${window.innerWidth}x${window.innerHeight}`);
      console.groupEnd();
    }
  }
};

// ãƒ‡ãƒãƒƒã‚°ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ä½¿ç”¨ã™ã‚‹ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ˜ãƒ«ãƒ—
console.info(`
ğŸ› ï¸ Debug utilities available:
- DF.api.checkAuth() - Check authentication status
- DF.api.forceRefreshToken() - Force refresh the auth token
- DF.logs.exportLogs() - Export console logs
- DF.logs.generateErrorReport() - Generate a report for sharing
- DF.env.info() - Show environment info
- DF.env.browser() - Show browser info
`);
```

### æ¨™æº–ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯çµ±åˆ

APIã‚µãƒ¼ãƒ“ã‚¹ã«å®šæœŸçš„ãªãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚’çµ±åˆï¼š

```typescript
// ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½
class HealthMonitor {
  private isRunning = false;
  private checkInterval = 30000; // 30ç§’ã”ã¨
  private intervalId: NodeJS.Timeout | null = null;
  private lastStatus: 'healthy' | 'unhealthy' | 'unknown' = 'unknown';
  private consecutiveFailures = 0;
  private apiService: any;
  
  constructor(apiService: any) {
    this.apiService = apiService;
  }
  
  // ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯é–‹å§‹
  start() {
    if (this.isRunning) return;
    
    console.log('ğŸ¥ Health monitoring started');
    this.isRunning = true;
    this.check(); // å³åº§ã«1å›ãƒã‚§ãƒƒã‚¯
    
    this.intervalId = setInterval(() => {
      this.check();
    }, this.checkInterval);
  }
  
  // ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯åœæ­¢
  stop() {
    if (!this.isRunning) return;
    
    console.log('ğŸ¥ Health monitoring stopped');
    this.isRunning = false;
    
    if (this.intervalId) {
      clearInterval(this.intervalId);
      this.intervalId = null;
    }
  }
  
  // ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
  async check() {
    try {
      const response = await this.apiService.get('/health');
      
      if (response.data.status === 'ok') {
        if (this.lastStatus !== 'healthy') {
          console.log('âœ… Backend is healthy');
        }
        this.lastStatus = 'healthy';
        this.consecutiveFailures = 0;
      } else {
        this.handleUnhealthy('Unexpected health status');
      }
    } catch (error) {
      this.handleUnhealthy(error.message);
    }
  }
  
  // ç•°å¸¸çŠ¶æ…‹ã®å‡¦ç†
  private handleUnhealthy(reason: string) {
    this.consecutiveFailures++;
    
    if (this.lastStatus !== 'unhealthy' || this.consecutiveFailures % 5 === 0) {
      console.warn(`âŒ Backend is unhealthy: ${reason} (Failure #${this.consecutiveFailures})`);
    }
    
    this.lastStatus = 'unhealthy';
    
    // 5å›é€£ç¶šã§å¤±æ•—ã—ãŸã‚‰ã‚¢ãƒ©ãƒ¼ãƒˆ
    if (this.consecutiveFailures === 5) {
      console.error('âš ï¸ Backend health check failed 5 times in a row');
      // å¿…è¦ã«å¿œã˜ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥
    }
  }
  
  // ç¾åœ¨ã®çŠ¶æ…‹ã‚’å–å¾—
  getStatus() {
    return {
      status: this.lastStatus,
      failures: this.consecutiveFailures,
      isMonitoring: this.isRunning
    };
  }
}

// APIã‚µãƒ¼ãƒ“ã‚¹ã«çµ±åˆ
const healthMonitor = new HealthMonitor(apiService);

// é–‹ç™ºç’°å¢ƒã§è‡ªå‹•çš„ã«é–‹å§‹
if (process.env.NODE_ENV === 'development') {
  healthMonitor.start();
}

// APIã‚µãƒ¼ãƒ“ã‚¹ã«è¿½åŠ 
apiService.health = {
  monitor: healthMonitor,
  check: () => healthMonitor.check(),
  start: () => healthMonitor.start(),
  stop: () => healthMonitor.stop(),
  status: () => healthMonitor.getStatus()
};
```

---

## å°å…¥æ–¹æ³•ã¨å„ªå…ˆé †ä½

ã“ã®ãƒ‡ãƒãƒƒã‚°æˆ¦ç•¥ã®å°å…¥ã«ãŠã‘ã‚‹å„ªå…ˆé †ä½ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

1. **æœ€å„ªå…ˆå®Ÿè£…:**
   - APIã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ãƒ­ã‚°å¼·åŒ– (api.service.ts)
   - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ­ã‚®ãƒ³ã‚°
   - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒãƒƒã‚°ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£

2. **é«˜å„ªå…ˆåº¦å®Ÿè£…:**
   - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
   - èªè¨¼ãƒ•ãƒ­ãƒ¼ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½
   - ãƒ­ã‚°ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½

3. **ä¸­å„ªå…ˆåº¦å®Ÿè£…:**
   - CORSå•é¡Œæ¤œå‡ºãƒ„ãƒ¼ãƒ«
   - ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆæ©Ÿèƒ½
   - ç’°å¢ƒæ¤œè¨¼ãƒ„ãƒ¼ãƒ«

4. **ä½å„ªå…ˆåº¦å®Ÿè£…:**
   - ãƒ‡ãƒãƒƒã‚°ã‚³ãƒãƒ³ãƒ‰ã‚»ãƒƒãƒˆ
   - ãƒ˜ãƒ«ã‚¹ãƒ¢ãƒ‹ã‚¿ãƒ¼
   - ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è‡ªå‹•åˆ†æ

## ä»Šå¾Œæ¤œè¨ã™ã¹ãé …ç›®

- ãƒ–ãƒ©ã‚¦ã‚¶æ‹¡å¼µæ©Ÿèƒ½ã«ã‚ˆã‚‹ãƒ‡ãƒãƒƒã‚°æ”¯æ´
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›£è¦–ãƒ„ãƒ¼ãƒ«
- æ€§èƒ½ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ãƒ„ãƒ¼ãƒ«
- è‡ªå‹•ã‚¨ãƒ©ãƒ¼ä¿®å¾©ææ¡ˆã‚·ã‚¹ãƒ†ãƒ 

---

## çµè«–

ä»Šå›ã®ãƒ‡ãƒãƒƒã‚°æˆ¦ç•¥ã¯ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–“ã®é€šä¿¡ã‚’é€æ˜åŒ–ã—ã€å•é¡Œã®æ—©æœŸç™ºè¦‹ã¨è§£æ±ºã‚’æ”¯æ´ã™ã‚‹ãŸã‚ã®ç·åˆçš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æä¾›ã—ã¾ã™ã€‚ã“ã®æˆ¦ç•¥ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒãƒƒã‚°ãƒ—ãƒ­ã‚»ã‚¹ãŒã‚ˆã‚Šæ§‹é€ åŒ–ã•ã‚Œã€åŠ¹ç‡çš„ã«ãªã‚Šã€é–‹ç™ºãƒãƒ¼ãƒ å…¨ä½“ã®ç”Ÿç”£æ€§ãŒå‘ä¸Šã—ã¾ã™ã€‚

ç‰¹ã«ã€APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ­ã‚®ãƒ³ã‚°å¼·åŒ–ã¨èªè¨¼ãƒ•ãƒ­ãƒ¼ã®ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½ã¯ã€æœ€ã‚‚ä¸€èˆ¬çš„ãªå•é¡Œã®æ ¹æœ¬åŸå› ã‚’è¿…é€Ÿã«ç‰¹å®šã™ã‚‹ãŸã‚ã«éå¸¸ã«é‡è¦ã§ã™ã€‚ã¾ãŸã€ç’°å¢ƒå·®ç•°ã®æ¤œå‡ºæ©Ÿèƒ½ã¯ã€ã€Œè‡ªåˆ†ã®ç’°å¢ƒã§ã¯å‹•ãã®ã«ã€ã¨ã„ã†å•é¡Œã‚’æ¸›ã‚‰ã™ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

ã“ã®æˆ¦ç•¥ã‚’é©åˆ‡ã«å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€DailyFortuneãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é–‹ç™ºãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«å…¨ä½“ã‚’é€šã˜ã¦ã€å•é¡Œè§£æ±ºã«ã‹ã‹ã‚‹æ™‚é–“ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã‚‹ã§ã—ã‚‡ã†ã€‚