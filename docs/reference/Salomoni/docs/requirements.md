# サロモニ（仮） 要件定義書

**バージョン**: 1.0.0  
**最終更新日**: 2025-05-13  
**ステータス**: ドラフト  

## 1. プロジェクト概要

### 1.1 目的と背景

サロモニは、スタイリストのモチベーション維持と日常的な悩みサポートを目的としたアプリケーションです。表向きは「美容師のモチベーション管理、経営管理アドバイザ」として位置づけられていますが、占い要素も取り入れることで、ユーザーの精神的なサポートを行います。

元々は占いアプリとして開発されましたが、アップルストアの審査基準に合わせた形で、プロフェッショナル向けのモチベーション管理ツールとして再構築されたものです。四柱推命をベースにした占い要素を維持しつつ、スタイリストの仕事上の課題やキャリア開発をサポートする機能を提供します。

### 1.2 ターゲットユーザー

- **スタイリスト**: 主にサロンで働く美容師・スタイリスト。20-30代が中心で、女性が多数。
- **キャリア中期のプロフェッショナル**: 特に業界経験3-5年程度で、モチベーション低下や将来への不安を感じることが多い層。
- **仕事とプライベートのバランスを模索する層**: 長時間労働や不規則な休日の中でワークライフバランスを求めるユーザー。
- **サロンオーナー/管理者**: スタイリストチームの管理や情報共有を行う立場の人物。

### 1.3 核となる機能と価値

以下は、プロジェクトの本質的価値を提供するために「絶対に必要」な機能です。各機能は「この機能がないとプロジェクトの目的達成が不可能になる」という基準で厳選されています。

- **AIチャットボット相談**: LINEのような親しみやすいチャットインターフェースで、自然な対話を通じてラポールを形成。写真共有やウェブ検索など多機能なコミュニケーションで、仕事やプライベートの悩みに対する相談相手となる。この機能がないとユーザーの個別の悩みに対応できず、パーソナライズされたサポートが提供できない。
- **今日のワンポイントアドバイス**: 四柱推命をベースにした占い要素で、モチベーション向上や新たな視点を提供。チャット内でシームレスに表示。この機能がないとユーザーの日常に変化や気づきを与えるきっかけが不足する。
- **パーソナライズされた体験**: ユーザーの生年月日や好みに基づき、AIとの対話や占い結果をカスタマイズ。この機能がないと、ユーザーごとの特性に合わせたサポートができず、関係性構築が困難になる。
- **管理者機能**: サロン単位でのユーザー管理と情報共有権限の設定。この機能がないとチーム間での相性情報共有やグループ管理ができない。

## 2. ユーザーインターフェース

### 2.1 チャットベースのUI設計

アプリケーションのメインインターフェースは、LINEやメッセンジャーアプリのようなチャットベースのUIを採用します。ユーザーは友達と会話しているような自然な感覚でAIと対話できます。

**主要特徴**:

- **会話中心の単一画面**: アプリの中心はチャットインターフェースで、ほとんどの機能はこの画面内で完結
- **メッセージバブル**: 発信者によって色分けされたバブル形式のメッセージ表示
- **リッチコンテンツ表示**: テキストだけでなく、画像、リンク、埋め込みカードなどを表示可能
- **メディア共有**: 写真のアップロードと共有機能
- **インタラクティブ要素**: ボタン、選択肢、スライダーなどの対話要素をチャット内に表示
- **会話の継続性**: セッション間でも会話コンテキストを維持

### 2.2 機能統合

チャットインターフェースは単なる会話ツールではなく、アプリの全機能を統合する中核として機能します：

- **占いアドバイスのインライン表示**: 「今日の運勢を教えて」と尋ねるとチャット内にリッチカードとして表示
- **ウェブ検索の組み込み**: 「〇〇について調べて」というリクエストに対し、検索結果をチャット内表示
- **写真分析**: アップロードされた写真に対するコメントやアドバイスを提供
- **目標・タスク管理**: チャット内で目標設定や進捗確認を行い、リマインダーも送信
- **設定変更**: 「通知をオフにして」など、チャット内コマンドで設定変更可能

### 2.3 視覚的アイデンティティ

- **親しみやすいデザイン**: 柔らかい色調と親しみやすいビジュアル要素
- **カスタマイズ要素**: テーマカラーやバックグラウンドの変更機能
- **AIキャラクターの視覚表現**: オプションとしてAIの表情やリアクションを表現するアイコン（必須ではない）
- **シンプルさ**: 機能が豊富でも見た目はシンプルに保ち、操作の複雑さを最小限に

### 2.4 専用運勢表示ページ

チャットインターフェースと併用して、より詳細な四柱推命分析結果を表示する専用ページを用意します。このページでは以下の情報が視覚的に整理されて表示されます：

- **命式表示**: ユーザーの生年月日から算出した四柱推命の命式を表示
- **大運表示**: 10年毎の大運をタイムライン形式で表示し、現在の大運と今後の運気の流れを可視化
- **年運グラフ**: 月々のバイオリズムをグラフ形式で表示し、エネルギーの波を視覚化
- **今日の運勢詳細**: 全体運、仕事運、対人運などのカテゴリ別運勢評価
- **ラッキーアイテム**: 今日の運勢を上昇させるアイテムやカラーの提案
- **相性の良いパートナー**: 登録済みの同僚や友人の中から、今日最も相性の良い人物を表示
- **注意ポイント**: 今日特に気をつけるべきポイントや避けた方が良い行動の助言

このページは「今日の運勢を詳しく見る」などのボタンからアクセスでき、チャットインターフェースから自然に遷移できる設計とします。

### 2.5 管理者向けバックオフィス

アプリの一般ユーザーインターフェースとは別に、管理者向けの専用バックオフィスインターフェースを提供します。このインターフェースはサロン単位での管理者が利用し、一般ユーザーからはアクセスできません。

**主要特徴**:

- **ダッシュボード**: ユーザー統計、利用状況、重要な通知などを一覧表示
- **ユーザー管理**: スタイリストや顧客の登録情報の確認、編集、削除機能
- **権限管理**: 情報共有レベルの設定やグループ管理
- **データエクスポート**: 必要に応じたデータのCSVエクスポート機能
- **設定管理**: サロン全体の設定やアプリ機能の有効/無効切り替え

## 3. チャットUI主要機能

### 3.1 コミュニケーション機能

- **テキストメッセージ**: 主要なコミュニケーション手段
- **写真共有**: カメラロールからの画像アップロードとAIによる応答
- **音声入力**: 音声からテキストへの変換機能
- **絵文字・スタンプ**: 感情表現のための視覚的要素
- **タイピングインジケーター**: AIが「入力中」の状態を表示

### 3.2 AI機能

- **自然言語理解**: ユーザーの質問や発言の意図を正確に理解
- **文脈記憶**: 前の会話を覚えていて連続した対話が可能
- **パーソナライズ**: ユーザーの好みや過去の対話に基づく応答調整
- **四柱推命分析**: 誕生日データに基づいた占いアドバイス
- **Webブラウジング**: 最新情報や特定トピックの検索と要約
- **心理的サポート**: ストレスや悩みに対する共感的な応答
- **目標設定支援**: キャリアや自己成長の目標設定とフォローアップ

### 3.3 表示コンテンツ

- **テキストメッセージ**: 標準的なチャットバブル
- **リッチカード**: 
  - 今日の運勢カード（全体運、仕事運、対人運など）
  - パートナー相性カード
  - 目標追跡カード
  - サロンマネジメントヒントカード
- **埋め込みリンク**: プレビュー付きウェブリンク
- **アクション要素**: 
  - 選択肢ボタン
  - 日付選択
  - スライダー（感情や満足度の評価など）
  - リマインダー設定UI

## 4. 四柱推命・運勢分析機能

### 4.1 命式算出システム

- **基本命式生成**: 生年月日時から四柱推命の命式（天干地支、五行など）を算出
- **大運計算**: 10年単位の運気の流れ（大運）を算出し表示
- **年運・月運・日運算出**: 年単位、月単位、日単位の運気変化を計算
- **相性分析**: 複数ユーザー間の相性を五行の相生相剋に基づいて分析

### 4.2 バイオリズム機能

- **月間バイオリズムグラフ**: 身体・感情・知性の3つの要素における波動をグラフ表示
- **ピーク日予測**: 各要素のピーク日とボトム日の予測と推奨活動
- **総合コンディション指数**: 3要素を統合した総合的なコンディション指数

### 4.3 運勢表示コンテンツ

- **全体運表示**: 今日の総合的な運気を5段階で表示し、簡潔なアドバイスを提供
- **仕事運表示**: 仕事面での運気とアドバイス（集中すべき業務、注意点など）
- **人間関係運表示**: 対人関係の運気と相性が良い/悪いタイプの特徴
- **ラッキーアイテム**: 今日の運気を高めるアイテム、カラー、場所などの提案
- **注意ポイント**: 今日特に注意すべき事項や避けるべき行動の提案
- **パートナー相性表示**: 登録されている同僚や友人から、今日最も相性の良い人を表示

### 4.4 表示形式バリエーション

- **シンプル表示**: チャット内で簡潔に表示する運勢サマリー
- **詳細表示**: 専用ページでの詳細な命式と解説
- **グラフ表示**: バイオリズムや運気の変化を視覚的に表すグラフ
- **カレンダー表示**: 月間の運気変化をカレンダー形式で一覧表示
- **相性マトリックス**: チーム内のメンバー間の相性を一覧表示

## 5. 管理者機能

管理者機能はPhase2で実装予定で、以下の3つの主要機能で構成されます。

### 5.1 ユーザー管理機能

- **スタイリスト一括登録**: CSVによる複数ユーザーの一括インポート機能
- **ユーザーアカウント管理**: スタイリストやクライアントの登録、編集、無効化
- **ユーザー情報閲覧**: 登録ユーザーの基本情報、生年月日、利用状況などの閲覧
- **役割設定**: ユーザーの役割（スタイリスト/管理者/顧客）の設定と管理
- **グループ管理**: サロン内でのチームやグループの作成、編集、メンバー管理

### 5.2 データ分析ダッシュボード

- **ユーザーアクティビティ統計**: ログイン頻度、利用時間、機能利用状況等の統計
- **人気機能分析**: 最も利用されている機能やコンテンツの統計
- **利用傾向分析**: ユーザーの利用パターンや行動傾向の可視化
- **四柱推命データ分析**: サロン全体での命式データの傾向や特徴の分析
- **レポート生成**: サロン管理者向けの定期的な利用状況レポート

### 5.3 共有設定管理

- **グループ作成機能**: 組織内のチーム分けとグループ管理
- **データ共有レベル設定**: 全体/グループ/個人レベルでの情報共有設定
- **プライバシー設定**: ユーザー間の情報共有レベルの設定（生年月日、命式情報など）
- **相性表示権限**: ユーザー間の相性情報表示の許可/制限設定
- **グループ相性マトリックス**: チーム内のメンバー間の相性を一覧表示する機能の管理

## 6. システム設計概要

### 6.1 アーキテクチャ

- **モバイルファースト**: ウェブアプリだがモバイル最適化設計
- **PWA対応**: ホーム画面へのインストール機能
- **オフライン対応**: 基本機能は限定的にオフラインでも動作
- **AIエンジン連携**: OpenAIのAPIを活用した高度な自然言語処理
- **データ永続化**: ユーザーの会話履歴やデータの安全な保存
- **マルチテナント**: サロン単位での分離されたデータ管理

### 6.2 データモデル概要

| エンティティ | 主な属性 | 関連エンティティ | 備考 |
|------------|----------|----------------|------|
| サロン | id, name, settings, ownerId | ユーザー, グループ | サロン単位の基本情報 |
| ユーザー | id, name, birthdate, birthtime, preferences, role | メッセージ, 運勢データ, 関係者, サロン | 認証情報と基本プロフィール |
| 関係者 | id, userId, name, birthdate, relationship | ユーザー | 同僚や友人など相性を見たい人物 |
| グループ | id, salonId, name, members | サロン, ユーザー | チームやグループ管理 |
| メッセージ | id, userId, content, type, timestamp | ユーザー | テキスト、画像、リッチカードなど |
| 運勢データ | userId, date, forecast(各種運勢), luckyItems | ユーザー | 日次生成のアドバイスデータ |
| 命式データ | userId, fourPillars, fiveElements, majorCycles | ユーザー | ユーザーの四柱推命基本データ |
| バイオリズム | userId, date, physical, emotional, intellectual | ユーザー | 日々のバイオリズム値 |
| 目標 | id, userId, title, deadline, progress | ユーザー | ユーザーの目標管理 |
| 共有設定 | userId, dataType, accessLevel, allowedUsers | ユーザー | 情報共有の権限設定 |

### 6.3 主要API

- **メッセージAPI**: チャットメッセージの送受信管理
- **四柱推命API**: 生年月日データからの運勢計算
- **相性分析API**: 複数ユーザー間の相性算出
- **バイオリズムAPI**: ユーザーの日次バイオリズム計算
- **認知API**: 画像認識や感情分析
- **統合検索API**: ウェブ検索結果の統合と要約
- **ユーザー管理API**: ユーザーの登録、編集、権限管理
- **グループ管理API**: グループの作成と管理
- **統計API**: 利用統計とレポート生成

## 7. 開発計画

| フェーズ | 内容 | 期間 | ステータス |
|---------|------|------|----------|
| フェーズ1 | Webバージョン基本機能開発（チャットUI、基本占い機能） | 2025年5月末まで | 進行中 |
| フェーズ2 | 管理者機能の開発（ユーザー管理、データ分析、共有設定）と相性分析強化 | 2025年6月 | 未着手 |
| フェーズ3 | アプリストア申請対応版開発 | 2025年7月 | 未着手 |
| フェーズ4 | フィードバック収集と機能拡張 | 2025年8月以降 | 未着手 |

## 8. 特記事項

- **プライバシー保護**: ユーザーの個人データと会話内容の保護を最優先
- **自然な対話体験**: AIの応答は温かみがあり、フレンドリーで共感的であること
- **アップルストア対応**: 占い表現をアドバイスとして適切に言い換え
- **柔軟性**: チャットベースのインターフェースを通じて新機能を容易に追加できる設計
- **アルゴリズム精度**: 四柱推命の計算精度と解釈の質を確保
- **データセキュリティ**: 特に管理者機能でのユーザー情報アクセスにおける厳格なセキュリティ対策