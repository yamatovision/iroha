<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èª¿å’Œã®ã‚³ãƒ³ãƒ‘ã‚¹ JSON ãƒ‘ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            background-color: #f9f9f9;
        }
        .result {
            white-space: pre-wrap;
            background-color: #eee;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            max-height: 300px;
            overflow: auto;
        }
        button {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 4px;
        }
        textarea {
            width: 100%;
            height: 200px;
            padding: 12px 20px;
            box-sizing: border-box;
            border: 2px solid #ccc;
            border-radius: 4px;
            background-color: #f8f8f8;
            resize: vertical;
            font-family: monospace;
        }
        h2 {
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 5px;
        }
        .success {
            color: green;
            font-weight: bold;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        .info {
            color: blue;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>èª¿å’Œã®ã‚³ãƒ³ãƒ‘ã‚¹ JSON ãƒ‘ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="card">
            <h2>ãƒ†ã‚¹ãƒˆ1: æ­£å¸¸ãªJSONï¼ˆcontentå½¢å¼ï¼‰</h2>
            <p>æ­£ã—ããƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸcontentå½¢å¼ã®JSONãƒ‡ãƒ¼ã‚¿</p>
            <textarea id="json1">{"version":"1.0","type":"harmony_compass","content":"# èª¿å’Œã®ã‚³ãƒ³ãƒ‘ã‚¹\n\n## æ ¼å±€ã«åŸºã¥ãæ€§æ ¼ç‰¹æ€§\nå¾“æ—ºæ ¼ã®æŒã¡ä¸»ã§ã‚ã‚‹ã‚ãªãŸã¯ã€è‡ªå·±è¡¨ç¾åŠ›ãŒå¼·ãã€ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã®ç´ è³ªã‚’å‚™ãˆã¦ã„ã¾ã™ã€‚ç”²æœ¨ã®æ—¥ä¸»ãŒå¼·ã„çŠ¶æ…‹ã«ã‚ã‚‹ãŸã‚ã€æ±ºæ–­åŠ›ãŒã‚ã‚Šã€è‡ªåˆ†ã®æ„è¦‹ã‚’ã¯ã£ãã‚Šã¨è¡¨æ˜ã™ã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚\n\n## å¼·åŒ–ã™ã¹ãæ–¹å‘æ€§\nç”¨ç¥ã§ã‚ã‚‹æ°´ï¼ˆæ­£å®˜ï¼‰ã‚’å¼·åŒ–ã™ã‚‹ã“ã¨ã§ã€ã‚ãªãŸã®å¼·ã„æœ¨ã®æ€§è³ªã«è¦å¾‹ã¨æ–¹å‘æ€§ã‚’ä¸ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\n## æ³¨æ„ã™ã¹ããƒãƒ©ãƒ³ã‚¹\nå‘½å¼ã«æ°´ã®è¦ç´ ãŒä¸è¶³ã—ã¦ã„ã‚‹ãŸã‚ã€æ„Ÿæƒ…ã®èµ·ä¼ãŒæ¿€ã—ããªã£ãŸã‚Šã€è‡ªåˆ¶å¿ƒãŒä½ä¸‹ã—ãŸã‚Šã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\n\n## äººé–“é–¢ä¿‚ã®æ™ºæ…§\nã‚ãªãŸã¯æ°´ã®æ€§è³ªã‚’æŒã¤äººï¼ˆæ€æ…®æ·±ãã€å†·é™ãªåˆ¤æ–­ãŒã§ãã‚‹äººï¼‰ã¨ã®é–¢ä¿‚ãŒèª¿å’Œçš„ã§ã™ã€‚\n\n## æˆé•·ã®ãŸã‚ã®èª²é¡Œ\nã‚ãªãŸã®ä¸»ãªèª²é¡Œã¯ã€å¼·ã™ãã‚‹è‡ªå·±è¡¨ç¾ã‚’é©åˆ‡ã«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã—ã€æŸ”è»Ÿæ€§ã¨é©å¿œåŠ›ã‚’é«˜ã‚ã‚‹ã“ã¨ã§ã™ã€‚"}</textarea>
            <button onclick="testParse('json1', 'result1')">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="result1" class="result"></div>
        </div>
        
        <div class="card">
            <h2>ãƒ†ã‚¹ãƒˆ2: æ­£å¸¸ãªJSONï¼ˆsectionså½¢å¼ï¼‰</h2>
            <p>æ­£ã—ããƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸsectionså½¢å¼ã®JSONãƒ‡ãƒ¼ã‚¿</p>
            <textarea id="json2">{"version":"1.0","type":"harmony_compass","sections":{"strengths":"ã‚ãªãŸã®å¼·ã¿ã¯è«–ç†çš„æ€è€ƒåŠ›ã¨åˆ†æèƒ½åŠ›ã§ã™ã€‚å•é¡Œã‚’ç´°åˆ†åŒ–ã—ã€åŠ¹ç‡çš„ã«è§£æ±ºã™ã‚‹èƒ½åŠ›ã«å„ªã‚Œã¦ã„ã¾ã™ã€‚","balance":"äº”è¡Œã®ãƒãƒ©ãƒ³ã‚¹ã§ã¯é‡‘ãŒå¼·ãã€æ°´ãŒå¼±ã„å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚æ„Ÿæƒ…è¡¨ç¾ã¨æŸ”è»Ÿæ€§ã‚’æ„è­˜çš„ã«å–ã‚Šå…¥ã‚Œã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸçŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚","relationships":"å¯¾äººé–¢ä¿‚ã§ã¯ã€èª å®Ÿã•ã¨ä¿¡é ¼æ€§ãŒé­…åŠ›ã¨ãªã£ã¦ã„ã¾ã™ã€‚ãŸã ã—ã€æ™‚ã«è·é›¢æ„Ÿã®å–ã‚Šæ–¹ãŒé›£ã—ãæ„Ÿã˜ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã§ã—ã‚‡ã†ã€‚","challenges":"æˆé•·ã®ãŸã‚ã«ã¯ã€æ„Ÿæƒ…è¡¨ç¾ã®å¹…ã‚’åºƒã’ã‚‹ã“ã¨ã¨ã€å®Œç’§ä¸»ç¾©ã®å‚¾å‘ã‚’å’Œã‚‰ã’ã‚‹ã“ã¨ãŒèª²é¡Œã¨ãªã‚Šã¾ã™ã€‚æŸ”è»Ÿæ€§ã‚’èº«ã«ã¤ã‘ã¾ã—ã‚‡ã†ã€‚"}}</textarea>
            <button onclick="testParse('json2', 'result2')">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="result2" class="result"></div>
        </div>
        
        <div class="card">
            <h2>ãƒ†ã‚¹ãƒˆ3: ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¦ã„ãªã„å¼•ç”¨ç¬¦ã‚’å«ã‚€JSON</h2>
            <p>å¼•ç”¨ç¬¦ãŒã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¦ã„ãªã„JSONãƒ‡ãƒ¼ã‚¿</p>
            <textarea id="json3">{"version":"1.0","type":"harmony_compass","content":"# èª¿å’Œã®ã‚³ãƒ³ãƒ‘ã‚¹\n\n## æ ¼å±€ã«åŸºã¥ãæ€§æ ¼ç‰¹æ€§\nã‚ãªãŸã®äº”è¡Œå±æ€§"é‡‘"ã«åŸºã¥ãã¨ã€ç²¾åº¦ã¨åŠ¹ç‡ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹è·æ¥­ã«é©æ€§ãŒã‚ã‚Šã¾ã™ã€‚"}</textarea>
            <button onclick="testParse('json3', 'result3')">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="result3" class="result"></div>
        </div>
        
        <div class="card">
            <h2>ãƒ†ã‚¹ãƒˆ4: æ—§å½¢å¼ãƒ†ã‚­ã‚¹ãƒˆ</h2>
            <p>JSONå½¢å¼ã§ã¯ãªã„å˜ãªã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿</p>
            <textarea id="json4">ã‚ãªãŸã®äº”è¡Œå±æ€§ã€Œé‡‘ã€ã«åŸºã¥ãã¨ã€ç²¾åº¦ã¨åŠ¹ç‡ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹è·æ¥­ã«é©æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã€ä¼šè¨ˆå£«ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã€ç·¨é›†è€…ã€å“è³ªç®¡ç†ã€çµŒå–¶ã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆãªã©ãŒå‘ã„ã¦ã„ã¾ã™ã€‚ç›®æ¨™é”æˆã¨å®Œç’§ã•ã‚’è¿½æ±‚ã™ã‚‹ã“ã¨ã«ã‚„ã‚ŠãŒã„ã‚’æ„Ÿã˜ã¾ã™ã€‚</textarea>
            <button onclick="testParse('json4', 'result4')">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="result4" class="result"></div>
        </div>
        
        <div class="card">
            <h2>ãƒ†ã‚¹ãƒˆ5: users.controller.tsã®ä¿®æ­£ç¢ºèª</h2>
            <p>æ­£ã—ãã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚ŒãŸJSONã‚’ç”Ÿæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ã®ãƒ†ã‚¹ãƒˆ</p>
            <textarea id="json5">const compassResult = { content: '# èª¿å’Œã®ã‚³ãƒ³ãƒ‘ã‚¹\n\n## æ ¼å±€ã«åŸºã¥ãæ€§æ ¼ç‰¹æ€§\nã‚ãªãŸã®äº”è¡Œå±æ€§"é‡‘"ã«åŸºã¥ãã¨ã€ç²¾åº¦ã¨åŠ¹ç‡ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹è·æ¥­ã«é©æ€§ãŒã‚ã‚Šã¾ã™ã€‚' };

// ä¿®æ­£å‰ï¼šã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ãªã—
const badJson = JSON.stringify({
  version: '1.0',
  type: 'harmony_compass',
  content: compassResult.content
});

// ä¿®æ­£å¾Œï¼šæ­£ã—ãã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
const goodJson = JSON.stringify({
  version: '1.0',
  type: 'harmony_compass',
  content: compassResult.content.replace(/"/g, '\\"')
});</textarea>
            <button onclick="testUsersController('json5', 'result5')">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="result5" class="result"></div>
        </div>
        
        <div class="card">
            <h2>ãƒ†ã‚¹ãƒˆ6: SajuProfileCard.tsxã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç¢ºèª</h2>
            <p>æ”¹å–„ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</p>
            <textarea id="json6">// SajuProfileCard.tsxã®å®Ÿè£…
try {
  // JSONå½¢å¼ã‹ã©ã†ã‹ã‚’ç¢ºèª
  let parsed;
  try {
    parsed = JSON.parse(profile.careerAptitude);
  } catch (parseError) {
    // JSONãƒ‘ãƒ¼ã‚¹ã«å¤±æ•—ã—ãŸå ´åˆã€å¾“æ¥å½¢å¼ã¨ã—ã¦æ‰±ã†
    throw new Error('JSONãƒ‘ãƒ¼ã‚¹ã«å¤±æ•—ã—ã¾ã—ãŸ');
  }

  if (parsed && parsed.type === 'harmony_compass') {
    // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«é–¢ã‚ã‚‰ãšHarmonyCompassã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨
    const HarmonyCompass = require('./HarmonyCompass').default;
    return <HarmonyCompass data={profile.careerAptitude} />;
  }
} catch (e) {
  // ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯å¾“æ¥ã®è¡¨ç¤ºæ–¹æ³•ã§è¡¨ç¤º
  console.log('èª¿å’Œã®ã‚³ãƒ³ãƒ‘ã‚¹ãƒ‡ãƒ¼ã‚¿ã§ã¯ãªã„ã‹ã€ãƒ‘ãƒ¼ã‚¹ã«å¤±æ•—ã—ã¾ã—ãŸ', e);
}</textarea>
            <button onclick="testErrorHandling('json6', 'result6')">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="result6" class="result"></div>
        </div>
    </div>

    <script>
        // æ–‡å­—åˆ—ãŒJSONã¨ã—ã¦æ­£ã—ãè§£æã§ãã‚‹ã‹ãƒ†ã‚¹ãƒˆã™ã‚‹é–¢æ•°
        function testParse(inputId, resultId) {
            const input = document.getElementById(inputId).value;
            const resultElement = document.getElementById(resultId);
            resultElement.innerHTML = "";
            
            try {
                // ã‚°ãƒ¬ãƒ¼ã‚¹ãƒ•ãƒ«ãªãƒ‘ãƒ¼ã‚¹å¯¾å¿œï¼ˆSajuProfileCard.tsxã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ¨¡å€£ï¼‰
                let parsed;
                let displayResult = "";
                
                try {
                    parsed = JSON.parse(input);
                    displayResult += '<span class="success">âœ… JSONã¨ã—ã¦æ­£å¸¸ã«ãƒ‘ãƒ¼ã‚¹ã§ãã¾ã—ãŸ</span>\n\n';
                    
                    // ãƒªã‚¶ãƒ«ãƒˆã«æƒ…å ±ã‚’è¡¨ç¤º
                    displayResult += "<b>ã€è§£æçµæœã€‘</b>\n";
                    if (parsed && typeof parsed === 'object') {
                        for (const key in parsed) {
                            if (key === 'content') {
                                displayResult += `<span class="info">- ${key}</span>: "${parsed[key].substring(0, 50)}..." (${parsed[key].length} æ–‡å­—)\n`;
                            } else if (key === 'sections') {
                                displayResult += `<span class="info">- ${key}</span>: (ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ) {\n`;
                                for (const section in parsed.sections) {
                                    displayResult += `  <span class="info">${section}</span>: "${parsed.sections[section].substring(0, 30)}..."\n`;
                                }
                                displayResult += '}\n';
                            } else {
                                displayResult += `<span class="info">- ${key}</span>: ${parsed[key]}\n`;
                            }
                        }
                    }
                    
                    // å‹ãƒã‚§ãƒƒã‚¯
                    if (parsed && parsed.type === 'harmony_compass') {
                        displayResult += "\n<span class=\"success\">âœ… harmony_compassã‚¿ã‚¤ãƒ—ã¨ã—ã¦èªè­˜ã•ã‚Œã¾ã—ãŸ</span>\n";
                        
                        // ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®åˆ¤å®š
                        if (parsed.content) {
                            displayResult += "<span class=\"info\">ğŸ“„ contentå½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã§ã™</span>\n";
                        } else if (parsed.sections) {
                            displayResult += "<span class=\"info\">ğŸ“‹ sectionså½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã§ã™</span>\n";
                        }
                    } else {
                        displayResult += "\n<span class=\"error\">âš ï¸ harmony_compassã‚¿ã‚¤ãƒ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“</span>\n";
                    }
                    
                    // SajuProfileCard.tsxã§ã®å‡¦ç†çµæœã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                    displayResult += "\n<b>ã€SajuProfileCard.tsxã§ã®å‡¦ç†çµæœã€‘</b>\n";
                    if (parsed && parsed.type === 'harmony_compass') {
                        displayResult += "<span class=\"success\">âœ… HarmonyCompassã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§è¡¨ç¤ºã•ã‚Œã¾ã™</span>\n";
                    } else {
                        displayResult += "<span class=\"error\">âŒ å¾“æ¥å½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã¾ã™</span>\n";
                    }
                    
                } catch (parseError) {
                    displayResult += "<span class=\"error\">âŒ JSONãƒ‘ãƒ¼ã‚¹ã«å¤±æ•—ã—ã¾ã—ãŸ:</span> " + parseError.message + "\n\n";
                    displayResult += "<span class=\"info\">âš ï¸ å¾“æ¥å½¢å¼ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™</span>\n";
                    
                    // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è©³ç´°ã‚’è¡¨ç¤º
                    if (parseError instanceof SyntaxError) {
                        const errorPos = parseError.message.match(/position (\d+)/);
                        if (errorPos && errorPos[1]) {
                            const pos = parseInt(errorPos[1]);
                            const context = input.substring(Math.max(0, pos - 20), pos) + 
                                          "<span style='color:red;font-weight:bold'>" + input.charAt(pos) + "</span>" + 
                                          input.substring(pos + 1, Math.min(input.length, pos + 20));
                            displayResult += "\n<b>ã€ã‚¨ãƒ©ãƒ¼ç®‡æ‰€ã€‘</b>\n..." + context + "...\n";
                        }
                    }
                    
                    // SajuProfileCard.tsxã§ã®å‡¦ç†çµæœã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                    displayResult += "\n<b>ã€SajuProfileCard.tsxã§ã®å‡¦ç†çµæœã€‘</b>\n";
                    displayResult += "<span class=\"info\">â„¹ï¸ å¾“æ¥å½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã¾ã™</span>\n";
                }
                
                resultElement.innerHTML = displayResult;
                
            } catch (error) {
                resultElement.innerHTML = "<span class=\"error\">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:</span> " + error.message;
            }
        }
        
        // users.controller.tsã®ä¿®æ­£ã‚’ç¢ºèªã™ã‚‹ãƒ†ã‚¹ãƒˆ
        function testUsersController(inputId, resultId) {
            const resultElement = document.getElementById(resultId);
            resultElement.innerHTML = "";
            
            try {
                // ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã‹ã‚‰JavaScriptã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œï¼ˆå®‰å…¨ãªã‚³ãƒ¼ãƒ‰ã®ã¿ï¼‰
                const code = document.getElementById(inputId).value;
                
                // å®Ÿè¡Œçµæœã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®HTML
                let displayResult = "<b>ã€ä¿®æ­£ç¢ºèªã€‘</b>\n\n";
                
                // ã‚³ãƒ¼ãƒ‰ã‚’è©•ä¾¡ï¼ˆå®‰å…¨ãªã‚³ãƒ¼ãƒ‰ã®ã¿ï¼‰
                let compassResult, badJson, goodJson;
                
                // å®‰å…¨ã«å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒ©ãƒƒãƒ‘ãƒ¼
                eval(`
                    ${code}
                    window._compassResult = compassResult;
                    window._badJson = badJson;
                    window._goodJson = goodJson;
                `);
                
                compassResult = window._compassResult;
                badJson = window._badJson;
                goodJson = window._goodJson;
                
                // å„JSONã®è§£æçµæœã‚’è¡¨ç¤º
                displayResult += "<b>ä¿®æ­£å‰ï¼ˆã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ãªã—ï¼‰:</b>\n";
                displayResult += `<pre>${badJson}</pre>\n`;
                
                try {
                    JSON.parse(badJson);
                    displayResult += "<span class=\"success\">âœ… ãƒ‘ãƒ¼ã‚¹æˆåŠŸ</span> - å•é¡Œã¯ã‚ã‚Šã¾ã›ã‚“\n\n";
                } catch (e) {
                    displayResult += `<span class=\"error\">âŒ ãƒ‘ãƒ¼ã‚¹å¤±æ•—:</span> ${e.message}\n\n`;
                }
                
                displayResult += "<b>ä¿®æ­£å¾Œï¼ˆã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚ã‚Šï¼‰:</b>\n";
                displayResult += `<pre>${goodJson}</pre>\n`;
                
                try {
                    JSON.parse(goodJson);
                    displayResult += "<span class=\"success\">âœ… ãƒ‘ãƒ¼ã‚¹æˆåŠŸ</span> - æ­£ã—ãä¿®æ­£ã•ã‚Œã¦ã„ã¾ã™\n\n";
                } catch (e) {
                    displayResult += `<span class=\"error\">âŒ ãƒ‘ãƒ¼ã‚¹å¤±æ•—:</span> ${e.message}\n\n`;
                }
                
                // æ¯”è¼ƒçµæœ
                displayResult += "<b>ã€æ¯”è¼ƒçµæœã€‘</b>\n";
                if (badJson !== goodJson) {
                    displayResult += "å¤‰æ›´ã‚ã‚Š: ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—å‡¦ç†ãŒè¡Œã‚ã‚Œã¦ã„ã¾ã™\n";
                    
                    // å…ƒã®content
                    displayResult += "\n<b>å…ƒã®content:</b>\n";
                    displayResult += `<pre>${compassResult.content}</pre>\n`;
                    
                    // ä¿®æ­£ãŒåŠ¹æœçš„ã‹ãƒã‚§ãƒƒã‚¯
                    if (compassResult.content.includes('"') && !badJson.includes('\\"')) {
                        displayResult += "<span class=\"error\">âš ï¸ ä¿®æ­£å‰ã®JSONã«ã¯éã‚¨ã‚¹ã‚±ãƒ¼ãƒ—å¼•ç”¨ç¬¦ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€ãƒ‘ãƒ¼ã‚¹æ™‚ã«å•é¡ŒãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™</span>\n";
                    } else {
                        displayResult += "<span class=\"info\">â„¹ï¸ ä¿®æ­£å‰ã®JSONã«ã¯ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ãŒå¿…è¦ãªæ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã›ã‚“</span>\n";
                    }
                    
                    if (compassResult.content.includes('"') && goodJson.includes('\\"')) {
                        displayResult += "<span class=\"success\">âœ… ä¿®æ­£å¾Œã®JSONã«ã¯å¼•ç”¨ç¬¦ãŒæ­£ã—ãã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¦ã„ã¾ã™</span>\n";
                    }
                } else {
                    displayResult += "<span class=\"info\">å¤‰æ›´ãªã—: ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—å‡¦ç†ã¯è¡Œã‚ã‚Œã¦ã„ã¾ã›ã‚“ï¼ˆå¿…è¦ãªã„ã‹ã€å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ãªã„ï¼‰</span>\n";
                }
                
                resultElement.innerHTML = displayResult;
                
            } catch (error) {
                resultElement.innerHTML = "<span class=\"error\">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:</span> " + error.message;
            }
        }
        
        // SajuProfileCard.tsxã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹é–¢æ•°
        function testErrorHandling(inputId, resultId) {
            const resultElement = document.getElementById(resultId);
            resultElement.innerHTML = "";
            
            try {
                // ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‚’è¡¨ç¤º
                let displayResult = "<b>ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆã€‘</b>\n\n";
                displayResult += "<span class=\"info\">SajuProfileCard.tsxã®ãƒ‘ãƒ¼ã‚¹å‡¦ç†:</span>\n";
                displayResult += "<pre>try {\n  // JSONå½¢å¼ã‹ã©ã†ã‹ã‚’ç¢ºèª\n  let parsed;\n  try {\n    parsed = JSON.parse(profile.careerAptitude);\n  } catch (parseError) {\n    // JSONãƒ‘ãƒ¼ã‚¹ã«å¤±æ•—ã—ãŸå ´åˆã€å¾“æ¥å½¢å¼ã¨ã—ã¦æ‰±ã†\n    throw new Error('JSONãƒ‘ãƒ¼ã‚¹ã«å¤±æ•—ã—ã¾ã—ãŸ');\n  }\n\n  // ãƒ‘ãƒ¼ã‚¹æˆåŠŸã—ãŸå ´åˆã®å‡¦ç†\n  if (parsed && parsed.type === 'harmony_compass') {\n    const HarmonyCompass = require('./HarmonyCompass').default;\n    return <HarmonyCompass data={profile.careerAptitude} />;\n  }\n} catch (e) {\n  // ã‚¨ãƒ©ãƒ¼å‡¦ç†ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰\n  console.log('èª¿å’Œã®ã‚³ãƒ³ãƒ‘ã‚¹ãƒ‡ãƒ¼ã‚¿ã§ã¯ãªã„ã‹ã€ãƒ‘ãƒ¼ã‚¹ã«å¤±æ•—ã—ã¾ã—ãŸ', e);\n}</pre>\n\n";
                
                // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
                displayResult += "<b>ã€ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã€‘</b>\n\n";
                
                // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹1: æ­£å¸¸ãªJSONãƒ‡ãƒ¼ã‚¿
                const validJson = JSON.stringify({
                    version: '1.0',
                    type: 'harmony_compass',
                    content: '# èª¿å’Œã®ã‚³ãƒ³ãƒ‘ã‚¹\n\næ­£ã—ããƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿'
                });
                
                displayResult += "<span class=\"info\">ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹1: æ­£å¸¸ãªJSONãƒ‡ãƒ¼ã‚¿</span>\n";
                displayResult += `<pre>${validJson}</pre>\n`;
                displayResult += "<span class=\"success\">âœ… çµæœ: ãƒ‘ãƒ¼ã‚¹æˆåŠŸ</span> â†’ HarmonyCompassã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§è¡¨ç¤º\n\n";
                
                // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹2: éã‚¨ã‚¹ã‚±ãƒ¼ãƒ—å¼•ç”¨ç¬¦ã‚’å«ã‚€JSONãƒ‡ãƒ¼ã‚¿
                const invalidJson = '{"version":"1.0","type":"harmony_compass","content":"# èª¿å’Œã®ã‚³ãƒ³ãƒ‘ã‚¹\n\n## æ ¼å±€ã«åŸºã¥ãæ€§æ ¼ç‰¹æ€§\nã‚ãªãŸã®äº”è¡Œå±æ€§"é‡‘"ã«åŸºã¥ãã¨ã€ç²¾åº¦ã¨åŠ¹ç‡ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹è·æ¥­ã«é©æ€§ãŒã‚ã‚Šã¾ã™ã€‚"}';
                
                displayResult += "<span class=\"info\">ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹2: éã‚¨ã‚¹ã‚±ãƒ¼ãƒ—å¼•ç”¨ç¬¦ã‚’å«ã‚€JSONãƒ‡ãƒ¼ã‚¿</span>\n";
                displayResult += `<pre>${invalidJson}</pre>\n`;
                displayResult += "<span class=\"error\">âŒ çµæœ: ãƒ‘ãƒ¼ã‚¹å¤±æ•—</span> â†’ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨å¾“æ¥å½¢å¼ã§è¡¨ç¤º\n\n";
                
                // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹3: å˜ç´”ãªãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
                const plainText = "ã‚ãªãŸã®äº”è¡Œå±æ€§ã€Œé‡‘ã€ã«åŸºã¥ãã¨ã€ç²¾åº¦ã¨åŠ¹ç‡ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹è·æ¥­ã«é©æ€§ãŒã‚ã‚Šã¾ã™ã€‚";
                
                displayResult += "<span class=\"info\">ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹3: ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿</span>\n";
                displayResult += `<pre>${plainText}</pre>\n`;
                displayResult += "<span class=\"error\">âŒ çµæœ: ãƒ‘ãƒ¼ã‚¹å¤±æ•—</span> â†’ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨å¾“æ¥å½¢å¼ã§è¡¨ç¤º\n\n";
                
                // ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ã®çµè«–
                displayResult += "<b>ã€çµè«–ã€‘</b>\n";
                displayResult += "<span class=\"success\">âœ… æ”¹å–„ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã«ã‚ˆã‚Šã€ãƒ‘ãƒ¼ã‚¹ã«å¤±æ•—ã—ãŸå ´åˆã§ã‚‚é©åˆ‡ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã•ã‚Œã¾ã™</span>\n";
                displayResult += "<span class=\"info\">ğŸ’¡ ã“ã‚Œã«ã‚ˆã‚Šã€æ—§å½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚„ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¦ã„ãªã„JSONãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹å ´åˆã§ã‚‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã¯ç¶­æŒã•ã‚Œã¾ã™</span>\n";
                
                resultElement.innerHTML = displayResult;
                
            } catch (error) {
                resultElement.innerHTML = "<span class=\"error\">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:</span> " + error.message;
            }
        }
    </script>
</body>
</html>